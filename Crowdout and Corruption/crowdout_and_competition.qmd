---
title: "Crowd-out and Competition: How non-governmental development programs shape public spending"
author: "Blaine Finstein"
format:
   pdf:
      documentclass: article
editor: source
latex_engine: xelatex
bibliography: crowdout.bib
link-citations: true
---

# Abstract

A large literature explores the effect of aid on public spending, showing that grants substitute for local revenue in some contexts but not others. However, development assistance is frequently provided by non governmental organizations (NGOs) which offer benefits directly to citizens and alongside public institutions with similar mandates to improve human welfare. I argue that non-governmental development programs also crowd out public spending, but that democratic institutions shape the incentive to shirk. I leverage a randomized evaluation of a World Bank community development program from the Philippines to substantiate these claims causally and show that crowd-out attenuates returns to human welfare. I also apply supervised machine learning to explore budget reallocation and offer evidence that NGOs reduce local tax collection and increase discretionary spending. These results document a significant but unexplored channel in the relationship between aid and political institutions and clarify a long-standing empirical puzzle. Aid shapes public spending, but democratic incentives determine whether this complements or corrodes the state.

\clearpage

# 1 Introduction

Foreign aid constitutes one of the most significant external forces shaping governance and welfare in the developing world. Each year, international donors and non-governmental organizations (NGOs) finance billions of dollars in projects designed to reduce poverty and improve human welfare. These interventions can yield substantial welfare gains. Yet, they also alter the incentives of governments that operate in the same service domains. When external actors assume responsibility for providing public goods, politicians may reduce spending or redirect resources elsewhere. As a result, programs that appear successful may inadvertently blunt their own long-term impact or weaken state capacity.

However, democratic institutions change how governments respond to external resources. When politicians depend on voters for reelection, aid can complement public provision by expanding resources for service delivery. But when accountability is weak, the same aid can substitute for domestic effort, allowing politicians to redirect public funds toward discretionary ends.

A large literature has extensively documented that intergovernmental grants and official development assistance can crowd out public spending (@feyzioglu1998; @chatterjee2012). However, this research has overwhelmingly focused on funds delivered \textit{to} governments. Far less is known about whether non-governmental development programs can produce similar substitution effects. In practice, these programs frequently overlap with local government mandates, offering services that municipalities might otherwise provide. If governments respond by cutting budgets or reallocating resources, even well-designed programs may yield attenuated welfare gains. Furthermore, empirical studies of crowd-out reach divergent conclusions. Some find strong crowd-out, while others find “flypaper effects” where aid appears to stick.

This paper examines how non-governmental development assistance shapes local public spending, and how political incentives mediate this relationship. I study these dynamics in the context of a randomized evaluation of Kapit-Bisig Laban sa Kahirapan–Comprehensive and Integrated Delivery of Social Services (Kalahi-CIDSS), a World Bank–financed community-driven development program in the Philippines. Kalahi-CIDSS disbursed grants to community committees for small-scale development projects, operating in parallel with local governments responsible for similar public goods. Importantly, the program was randomly assigned across municipalities, enabling causal inference on both governance and welfare outcomes.

I advance three central findings. First, I show that non-governmental development programs can crowd out local public spending. Using granular panel data on quarterly municipal budgets, I estimate treatment effects of Kalahi-CIDSS on public financing. The results indicate that Kalahi-CIDSS significantly reduced local government expenditures in overlapping service sectors with no compensating increases in other budget categories. This finding broadens the scope of aid fungibility theory: crowd-out can occur even when financing bypasses government budgets.

Second, I demonstrate that electoral competition, the core institutional mechanism of democratic accountability, explains why crowd-out occurs in some contexts but not others. I argue that these differences arise from variation in political accountability. In competitive municipalities, incumbents must maintain service provision to retain voter support, mitigating the incentive to shirk when external assistance arrives. In contrast, politicians in less competitive environments can scale back spending without electoral cost. Using municipal election returns, I show that crowd-out effects are concentrated in low-competition settings, while competitive municipalities maintain spending. This mechanism helps reconcile a long-standing empirical puzzle.

Third, I trace the welfare consequences of crowd-out. Combining data from the Kalahi-CIDSS impact evaluation with a natural fiscal shock that temporarily constrained municipal budgets during program implementation, I examine how reductions in public spending affect the program’s human development outcomes. A difference-in-differences analysis of household and community welfare indicators shows that while Kalahi-CIDSS improved welfare, these effects were significantly smaller when local governments retained full budgetary control. This pattern indicates that crowd-out attenuated the welfare benefits of development assistance.

Finally, I complement these analyses with an exploratory application of supervised machine learning to examine broader fiscal reallocation. Using variable importance measures from random forest, I identify which budget categories were most affected by Kalahi-CIDSS treatment. The results suggest systematic reallocation away from social services and local tax collection toward discretionary spending categories such often associated with political patronage. This approach offers a novel methodological contribution, applying flexible statistical learning tools to detect government budgetary responses to aid.

Furthermore, few studies on aid fungibility offer RCT-based evidence. Grants are rarely randomly allocated and researchers frequently rely on quasi-experimental methods. Given that aid agencies target their programs to underdeveloped and low-resourced regions which may spend differently, research designs with credible causal identification are crucial. Looking at the effects of aid on public spending from an RCT specifically allows me to disentangle where development agencies work from the effect of their work on political institutions.

Together, these findings reveal that democratic institutions determine the fiscal and developmental consequences of aid. In politically competitive settings, aid complements public provision; in less competitive ones, it substitutes for it. The results bridge two debates on the fungibility of aid and on the fiscal consequences of democratic accountability, demonstrating that the effectiveness of development programs depends as much on political institutions as on program design. Where accountability is strong, external assistance can reinforce governance. Where it is weak, it can erode it.

The paper proceeds as follows. Section 2 develops a theoretical framework linking non-governmental development assistance, fiscal substitution, and political accountability. Section 3 describes the institutional context of Kalahi-CIDSS and presents the empirical strategy. Section 4 reports the main results on municipal spending, demonstrating that Kalahi-CIDSS reduced public investment in social services and that this effect was mitigated in competitive municipalities. Section 5 links these fiscal dynamics to welfare outcomes using survey data from the impact evaluation, showing that crowd-out attenuated infrastructure-related welfare improvements. Section 6 complements these analyses with a supervised learning approach that identifies which budget categories were most sensitive to treatment and offers suggestive evidence that grants financed patronage appointments. Section 7 concludes.

# 2 Theory

Throughout the developing world, public institutions and aid agencies offer similar services to a limited population of overlapping beneficiaries. Villages receive water purification or electrification projects installed by an NGO while people in other parts of the country enjoy clean drinking water and electricity provided by a government utilities system. Children are inoculated in UNICEF vaccination drives while enrolled in a government health insurance scheme. Households benefit from cash transfers, literacy campaigns, or health interventions financed by donors, while governments fund similar initiatives through local budgets. These parallel structures of service delivery create a shared domain of welfare provision in which aid and the state coexist and potentially compete.

Non-governmental development assistance can thus alter the incentives of both citizens and politicians. For citizens, direct NGO provision reduces dependence on public services and weakens the electoral sanction for underperforming incumbents. For politicians, aid offers an opportunity to reallocate limited fiscal resources elsewhere, either toward politically salient but less productive spending, or to private rents. In the absence of electoral pressure, incumbents may rationally reduce public investment in sectors served by aid agencies. The result is crowd-out: aid replaces rather than complements government spending. However, when voters reward visible local investment and competition is intense, politicians may maintain or even increase spending to claim credit for improved welfare outcomes, producing a crowd-in effect.

## Fiscal substitution and the logic of crowd-out

The logic of fiscal substitution is rooted in the economics of intergovernmental transfers and aid fungibility. When external resources are provided for specific purposes, recipient governments internalize them as additional income, relaxing local budget constraints. Classic models of fiscal federalism predict that such grants displace rather than augment domestic spending (@oates1972; @zampelli1986). Politicians and bureaucrats seek to maximize discretionary resources. When aid covers one category of spending, locally raised revenues can be redirected toward others, often those yielding greater political returns.

Empirically, this dynamic has been observed in numerous settings. Cross-national analyses estimate that up to 70 percent of official development assistance is fungible (@chatterjee2012), while studies of tax effort find that aid inflows weaken domestic revenue mobilization, particularly in low-capacity states (@benedek2014). These patterns mirror those observed in intergovernmental transfers, where grants to subnational governments frequently displace local spending rather than augment it.

Yet, evidence of crowd-in, where aid or grants increase total public spending, muddies the picture. The “flypaper effect” literature demonstrates that fiscal transfers often “stick where they hit”. Local governments spend more following external grants than they would following equivalent increases in local income (@hines1995). Studies from contexts as diverse as Sweden (@dahlberg2008), Tanzania (@masaki2018), and the Philippines (@troland2016) document such complementarities.

## Political competition and the incentive to shirk

Why does aid substitute for public spending in some contexts but complement it in others? I argue that political incentives structure government responses to external resources. Politicians operate within electoral environments that determine the costs and benefits of fiscal adjustment, and these incentives shape whether they exploit or resist the opportunity to substitute development assistance for public spending. In settings of limited competition, incumbents face weak electoral constraints and can reduce visible service provision without meaningful political cost. Aid effectively frees funds that can be redirected toward discretionary spending. Conversely, in competitive constituencies, incumbents must sustain observable public investment to retain voter support.

Electoral cycles shape public spending in predictable ways. The political business cycle literature shows that incumbents use expansionary fiscal policies before elections to reduce unemployment, stimulate growth, and improve their chances of reelection (@nordhaus1975; @rogoff1988). These dynamics are especially pronounced in developing democracies where institutional constraints are weaker and voters rely on short-term economic performance as a proxy for competence (@brender2005; @shi2006). In the Philippines, for instance, local governments exhibit increased spending prior to elections, particularly in politically salient sectors such as infrastructure and social services (@labonne2016).

Yet electoral pressure does more than influence timing. It shapes the composition of spending as well. Political competition increases the incentive to deliver public goods. Governments in competitive environments spend more on basic services and are less likely to divert funds to patronage or private consumption. Comparative evidence supports this logic: @harding2014 finds that countries with greater competition allocate more resources to education, @Burgess2015 show that Kenyan road investments exhibit less ethnic favoritism under democracy, and @ferraz2011 demonstrate that competition reduces corruption and increases local public goods in Brazil.

However, non-governmental aid complicates this equilibrium. When NGOs or international organizations provide visible public goods, politicians may exploit these projects for electoral advantage. Evidence from the Philippines shows that politicians claim credit for NGO-implemented projects and that voters often fail to distinguish between government and non-government programs (@cruz2017). This ability to appropriate credit changes the strategic calculus of incumbents. In low-competition or information-poor settings, politicians can maintain electoral support even if they reduce local spending, because NGO projects create the appearance of productivity.

The ability of politicians to appropriate credit for NGO projects and reduce public expenditure is thus conditional on the political environment. In competitive constituencies, opposition candidates, journalists, and civic actors have strong incentives to monitor and publicize government behavior, increasing voters’ awareness of who is actually responsible for public goods. These environments tend to be more information-rich: elections are closely contested, media coverage is broader, and voters are more attentive to performance. In such settings, incumbents cannot rely solely on symbolic association with externally funded projects. To credibly claim credit and ensure that constituents attribute welfare improvements to their administration, they must demonstrate visible co-investment or complementary provision. By contrast, in low-competition environments, where challengers are weak, media oversight is limited, and voters rely on symbolic cues, incumbents can plausibly claim ownership of externally funded projects while simultaneously cutting their own spending. Political competition and electoral incentives thus determine whether aid amplifies or undermines accountability, producing fiscal crowd-in under electoral constraint and crowd-out where such constraint is absent.

This framework reconciles seemingly contradictory findings. Economic models of substitution predict that aid will crowd out public spending, yet empirical studies frequently identify cases of fiscal complementarity. The theory proposed here suggests that both outcomes are possible and depend on democratic institutions. Where competition is weak, aid enables fiscal substitution. Where competition is strong, it crowds in spending by raising the electoral cost of inaction.

This logic yields two testable implications. Non-governmental development assistance shapes public resource allocation, potentially reducing it in the same domains. Furthermore, aid will reduce public spending in low-competition municipalities but have weaker or even positive effects in competitive ones. The empirical analysis that follows tests these claims using data from a randomized evaluation of the Kalahi-CIDSS community-driven development program in the Philippines, examining how variation in electoral pressure moderates the consequences of aid for public spending.

# 3 Data and Empirical Strategy

Established in 2003, Kapit-bisig Laban sa Kahirapan ("Linking Arms Against Poverty") -- Comprehensive and Integrated Delivery of Social Services (Kalahi-CIDSS) aims to reduce poverty and increase local participatory governance in the Philippines. While operated today by the Department of Social Welfare and Development of the Philippines, it began as a program of the World Bank. Kalahi-CIDSS delivers grants to qualifying municipalities for small-scale community development projects, such as farm-to-market roads, health stations, and irrigation and drainage systems.[^1] Communities determine how to allocate funds democratically in order to meet their particular needs. In addition to financing local development projects, Kalahi-CIDSS trains community members in choosing, designing, and implementing projects.

[^1]: Municipal poverty rate is the predominant qualification for Kalahi-CIDSS. In the Philippines, municipalities are rated on a class scale of 1 (wealthiest) to 6 (poorest). In order to receive Kalahi-CIDSS, 4th -- 6th class municipalities must have a poverty incidence above the national average of 26.5%, based on the 2009 Small Area Estimates (SAE) of the National Statistical Coordination Board (NSCB). 1st -- 3rd class municipalities qualify if they have a poverty incidence of 40% or higher (@dswd2024).

From 2011-2015, Innovations for Poverty Action (IPA) conducted an impact evaluation of Kalahi-CIDSS aiming to evaluate the effects of the program on key socioeconomic and governance outcomes via a randomized controlled trial (RCT). The impact evaluation spanned 198 municipalities across all three of the main island groups of the Philippines (Luzon, the Visayas, and Mindanao). While the exact timing of grant allocation varied, municipalities selected for treatment received one grant per year from 2013-2015. These were calculated per municipality on the basis of its number of barangays, the smallest administrative unit in the Philippines and the level at which citizen committees were organized. While all barangays in a participating municipality were eligible to receive Kalahi-CIDSS, funds were allotted in accordance with project priorities.[^2] Figure 1 displays a map of the location of treated and control municipalities across the Philippines.

[^2]: For a detailed review of selection criteria for the IPA impact evaluation, see @beatty2018. More information on project priorities and funds allocation within a given municipality can be found on the website of the Department of Social Welfare and Development (DSWD) of the Philippines, the federal agency that administers Kalahi-CIDSS (@dswd2024).

Kalahi-CIDSS was found to substantially improve welfare outcomes. Infrastructure projects reduced the time to key services and the cost to get farm products to market, water-related projects reduced the time and cost to obtain it, and education initiatives increased school enrollments (@beatty2018).

In order to evaluate whether municipal governments exploited Kalahi-CIDSS to reduce public spending, I construct an original panel data set of quarterly budget allocation and electoral outcomes at the municipal level across the Philippines.[^3] I estimate treatment effects among the IPA impact evaluation sample for the years in which grants were given to all treated municipalities (2013 through 2015). The outcome for my key specifications is per capita public service spending in Philippine pesos, as impact evaluation data do not allow me to disentangle the specific projects implemented in a given municipality.

[^3]: Data on local government spending are obtained from the Bureau of Local Government Finance of the Philippines. Data on the IPA impact evaluation of Kalahi-CIDSS are publicly available through the Millennium Challenge Corporation Evidence Platform of the ICPSR (@ipa2019). Grant allocation years and other qualitative information on implementation of the randomized controlled trial are derived from the third round impact evaluation report (@beatty2018). Data on municipalities included in the impact evaluation affected by Typhoon Yolanda are obtained from the Kalahi-CIDSS supplementary documentation from the Asian Development Bank (@asiandevelopmentbank). I merge these data with 2013 municipal election returns published by the Commission on Elections of the Philippines (COMELEC), which are the local election results immediately preceding the intervention.

On November 8, 2013, nearly one year into grant implementation, Typhoon Yolanda (international name Haiyan) struck the Philippines. One of the most powerful tropical cyclones ever recorded, Yolanda killed at least 6,300 Filipinos and is estimated to have cost the Philippine government nearly \$13 billion USD (@worldbank). Given the impact on public spending, I code a dichotomous variable for whether a municipality received heavy damage from Yolanda and $0$ otherwise, as documented by the Asian Development Bank materials on the impact of Yolanda on Kalahi-CIDSS regions (@asiandevelopmentbank). As the Philippine government continued recovery efforts for years after Yolanda, this variable takes the value of $1$ for high-impact municipalities for all quarters in my sample following the storm.

<!-- I include a number of additional covariates as well. These include population ($\pi_{i}$), land area ($\lambda_{i}$), and poverty index ($\rho_{i}$). I also include region and quarter fixed effects, represented by the terms $\alpha_{r}$ and $\delta_{t}$, respectively. The error term $\epsilon_{rt}$ is clustered at the region by quarter level. In order to standardize comparison across municipalities of varying sizes, all public spending variables are measured per capita. -->

I plot balance on pre-treatment public spending in Figure 2. I perform balance tests for all pre-treatment covariates as well via randomization inference and provide results in appendix Table A1.[^4]

[^4]: Randomization inference was conducted by simulating 100 random assignments consistent with the procedure employed in the impact evaluation to compute randomization-based p-values for overall and individual covariate balance. Neither the overall p-value nor the p-values of any individual covariates are statistically significant at conventional levels ($p<.05$).

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Load packages
library(tidyverse)
library(modelsummary)
library(randomForest)
library(ggplot2)
library(caret)
library(pROC)
library(gt)
library(kableExtra)
library(tidyr)
library(readxl)
library(estimatr)
library(sf)
library(haven)

# Load and clean Kalahi replication data to match budgets to treat and control
matching_dat <- read_csv("Data/KALAHI/PHL-KC Matching Data for Sample/matching data for sample.csv") |> 
  mutate(reg_psgc = case_when(
    reg_psgc == "IV-A" ~ "Calabarzon",
    reg_psgc == "V" ~ "Bicol",
    reg_psgc == "CAR" ~ "Cordillera Administrative Region",
    reg_psgc == "IV-B" ~ "Mimaropa",
    reg_psgc == "IX" ~ "Zamboanga",
    reg_psgc == "VI" ~ "Western Visayas",
    reg_psgc == "VII" ~ "Central Visayas",
    reg_psgc == "VIII" ~ "Eastern Visayas",
    reg_psgc == "X" ~ "Northern Mindanao",
    reg_psgc == "XI" ~ "Davao",
    reg_psgc == "XII" ~ "SOCCSKSARGEN",
    .default = "Caraga"
  )) |> 
  rename(lgu = mun, region = reg_psgc, treat = treatment) |> 
  dplyr::select(island, region, lgu, treat, pi, bgytot, pop07nso, land) |> 
  mutate(lgu = case_when(
    lgu == "Villa Viciosa" ~ "Villaviciosa",
    lgu == "Catarman (CAPITAL)" ~ "Catarman",
    lgu == "General Macarthur" ~ "General MacArthur",
    lgu == "Macarthur" ~ "MacArthur",
    lgu == "Brooke's point" ~ "Brooke's Point",
    lgu == "El Nido (Bacuit)" ~ "El Nido",
    lgu == "Romblon (CAPITAL)" ~ "Romblon",
    lgu == "Lau-an" ~ "Lau An",
    lgu == "Tobias Fornier (Dao)" ~ "Tobias Fornier",
    lgu == "Ipil (CAPITAL)" ~ "Ipil",
    lgu == "Roseller Lim" ~ "R. T. Lim",
    lgu == "Licuan-Baay (Licuan)" ~ "Baay Licuan",
    lgu == "Asuncion (Saug)" ~ "Asuncion",
    lgu == "Lambayong (Mariano Marcos)" ~ "Lambayang",
    lgu == "Santa monica (Sapao)" ~ "Santa Monica",
    lgu == "San Francisco (Anao-aon)" ~ "San Francisco",
    lgu == "Lau-an" ~ "Lau An",
    lgu == "Anini-y" ~ "Anini Y",
    .default = lgu)) |> 
  arrange(region, lgu)

matching_dat[155, 3] <- "Sofronio Espanola"

# Create binary variable for Yolanda damage and add to Kalahi data
yolanda <- c("Gumaca", "Lopez", "General Nakar", "Tagkawayan", "Mauban", "San Antonio", "Real",
             "Alabat", "General Luna", "Padre Burgos", "Quezon", "Agdangan", "Montevista",
             "Pantukan") |> 
  append(as.character(as.matrix(subset(matching_dat, region == "Mimaropa", select = lgu)))) |> 
  append(as.character(as.matrix(subset(matching_dat, region == "Bicol", select = lgu)))) |> 
  append(as.character(as.matrix(subset(matching_dat, region == "Western Visayas", select = lgu)))) |>
  append(as.character(as.matrix(subset(matching_dat, region == "Central Visayas", select = lgu)))) |>
  append(as.character(as.matrix(subset(matching_dat, region == "Eastern Visayas", select = lgu)))) |>
  append(as.character(as.matrix(subset(matching_dat, region == "Caraga", select = lgu))))

matching_dat <- matching_dat |> mutate(yolanda = ifelse(lgu %in% yolanda, 1, 0))

## Create political vars

# Function to process a single Excel file for vote share calculation
process_single_file <- function(file_path) {
  
  # Extract the region name from the second-level folder in the path
  path_parts <- str_split(file_path, "/", simplify = TRUE)
  region <- ifelse(length(path_parts) >= 2, path_parts[length(path_parts) - 2], NA)
  region <- str_replace_all(region, "REGION ", "")
  region <- str_replace_all(region, "C.A.R.", "CAR")
  region <- str_replace_all(region, "^\\d+$", as.character(as.roman(region)))
  region <- str_replace_all(region, "4A", "IV-A")
  region <- str_replace_all(region, "4B", "IV-B")
  
  # Check if the sheet "MAYOR" exists
  sheet_names <- excel_sheets(file_path)

  # Read the mayor sheet
  if ("MAYOR" %in% sheet_names) {
  mayor_data <- read_excel(file_path, sheet = "MAYOR")
} else if ("Mayor" %in% sheet_names) {
  mayor_data <- read_excel(file_path, sheet = "Mayor")
} else {
  return(NULL)
}
  
  # Exclude metadata columns to identify vote columns
  metadata_cols <- c("Region", "Province", "Municipality/City", "Barangay", "Precinct Code",
                     "Actual Voters Voted", "Contest Name")
  vote_columns <- setdiff(colnames(mayor_data), metadata_cols)
  
  # Ensure vote columns exist
  if (length(vote_columns) == 0) {
    warning(sprintf("No vote data found in file %s.", file_path))
    return(NULL)
  }
  
  summarized_votes <- mayor_data |> 
  dplyr::select(all_of(vote_columns)) |> 
  mutate(across(everything(), ~ as.numeric(gsub(",", "", .)))) |>   # remove commas, convert to numeric
  summarize(across(everything(), sum, na.rm = TRUE)) |> 
  pivot_longer(everything(), names_to = "candidate", values_to = "votes")
  
  # Calculate total votes and vote share
  total_votes <- sum(mayor_data$"Actual Voters Voted", na.rm = T)
  if (total_votes == 0) {
    warning(sprintf("No votes recorded in file %s.", file_path))
    return(NULL)
  }
  
  summarized_votes <- summarized_votes |> 
    mutate(vote_share = votes / total_votes) |> 
    arrange(desc(vote_share))
  
  # Extract the winner and handle cases with no runner-up
  winner <- summarized_votes[1, ]
  runner_up <- if (nrow(summarized_votes) > 1) summarized_votes[2, ] else data.frame(candidate = NA,
                                                                                     votes = 0,
                                                                                     vote_share = 0)
  
  # Calculate vote difference
  vote_diff <- winner$vote_share - runner_up$vote_share
  
  # Format municipality name to proper case
  mun <- str_to_title(tools::file_path_sans_ext(basename(file_path)))
  
  data.frame(
    region = region,
    mun = mun,
    winner = winner$candidate,
    uncontested = ifelse(is.na(runner_up$candidate), 1, 0),
    vote_share = winner$vote_share,
    vote_diff = vote_diff
  )
}

# Function to process all files in a folder and its subdirectories
process_mayoral_results <- function(folder_path) {
  # List all Excel files in the folder and its subdirectories
  excel_files <- list.files(folder_path, full.names = TRUE, recursive = TRUE)
  results <- lapply(excel_files, process_single_file)
  bind_rows(results)
}

# Process files and ensure no duplicate lgu names to avoid multiple matches upon join
election_returns <- process_mayoral_results("Data/Elections")

## Create quarterly spending data

process_quarterly <- function(file_path, sheet_name = NULL) {
  data <- read_excel(file_path, sheet = sheet_name, col_names = FALSE)
  
  # Identify the last cell with text in the first 5 rows
  column_names <- data[1:10, ]|> 
    as.data.frame() |> 
    summarise_all(~ last(na.omit(.))) |> 
    unlist()
  
  # Clean column names
  cleaned_column_names <- column_names |> 
    str_to_lower() |> 
    str_replace_all(" ", "_") |> 
    str_replace_all("/", "_") |> 
    str_replace_all("[^a-z_]", "") |> 
    str_replace_all("_+", "_")
  
  # Set the new column names, eliminate the first 5 rows, and clean municipality names
  cleaned_data <- data[-(1:10), ] |> 
    setNames(cleaned_column_names) |> 
    filter(lgu_type == "Municipality") |> 
    dplyr::select(-c(lgu_type)) |> 
    rename(mun = lgu_name) 
  cleaned_data <- cleaned_data |> 
    mutate(across(4:ncol(cleaned_data), as.numeric)) |> 
    mutate(quarter = str_match(sheet_name, "Q[1-4]20[0-1][0-9]")[, 1],
           year = str_match(sheet_name, "20[0-1][0-9]")[, 1],
           .before = general_fund) |>
    mutate(kalahi_spending = rowSums(across(c(education_culture_sports_manpower_development,
                                              health_nutrition_population_control,
                                              housing_and_community_development,
                                              social_services_and_social_welfare,
                                              general_public_services)),
                                     na.rm = TRUE),
           total_spending = rowSums(across(c(total_current_operating_expenditures,
                                             total_nonoperating_expenditures,
                                             total_nonincome_receipts)),
                                    na.rm = TRUE),
           .before = general_fund) |> 
    mutate(region = str_replace_all(str_replace_all(region, "Region ", ""), " Region", "")) |>
    mutate(region = str_replace_all(region, "MIMAROPA", "IV-B")) |> 
    mutate(mun = ifelse(grepl("Sofronio", mun), "Sofronio Espanola", mun)) |> 
    mutate(mun = ifelse(grepl("Roseller", mun), "Roseller Lim", mun)) |> 
    mutate(mun = ifelse(grepl("Villaviciosa", mun), "Villa Viciosa", mun)) |> 
    mutate(mun = ifelse(grepl("Brooke", mun), "Brooke's Point", mun))
  
  return(cleaned_data)
}

# Read in and clean data
dat <- process_quarterly("Data/Quarterly Spending/SRE-QTR-2013.xlsx", sheet = "Q12013") |>
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2013.xlsx", sheet = "Q22013")) |> 
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2013.xlsx", sheet = "Q32013")) |>
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2013.xlsx", sheet = "Q42013")) |> 
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2014.xlsx", sheet = "Q12014")) |>
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2014.xlsx", sheet = "Q22014")) |> 
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2014.xlsx", sheet = "Q32014")) |>
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2014.xlsx", sheet = "Q42014")) |> 
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2015.xlsx", sheet = "Q12015")) |>
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2015.xlsx", sheet = "Q22015")) |> 
  rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2015.xlsx", sheet = "Q32015"))
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2015.xlsx", sheet = "Q42015")) |> 
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2009.xlsx", sheet = "Q12009")) |>
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2009.xlsx", sheet = "Q22009")) |> 
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2009.xlsx", sheet = "Q32009")) |>
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2009.xlsx", sheet = "Q42009")) |> 
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2010.xlsx", sheet = "Q12010")) |>
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2010.xlsx", sheet = "Q22010")) |> 
  #rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2010.xlsx", sheet = "Q32010")) |>
  #rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2010.xlsx", sheet = "Q42010"))
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2011.xlsx", sheet = "Q12011")) |>
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2011.xlsx", sheet = "Q22011")) |> 
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2011.xlsx", sheet = "Q32011")) |> 
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2011.xlsx", sheet = "Q42011")) |> 
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2012.xlsx", sheet = "Q12012")) |>
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2012.xlsx", sheet = "Q22012")) |> 
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2012.xlsx", sheet = "Q32012")) |> 
  # rbind(process_quarterly("Data/Quarterly Spending/SRE-QTR-2012.xlsx", sheet = "Q42012"))

# Merge w covariates
dat <- read_csv("Data/KALAHI/PHL-KC Matching Data for Sample/matching data for sample.csv") |> 
  rename(region = reg_psgc, treat = treatment) |> 
  mutate(mun = gsub(" \\(.*$", "", iconv(mun, from = "", to = "UTF-8", sub = "byte"))) |> 
  mutate(mun = ifelse(grepl("Sofronio", mun), "Sofronio Espanola", mun)) |> 
  dplyr::select(-c(island, mun_psgc, pairnum)) |> 
  group_by(region, mun) |> 
  filter(n() == 1) |> 
  ungroup() |> 
  left_join(dat, by = c("region", "mun")) |> 
  filter(!is.na(treat)) |> 
  mutate(kalahi_spending_percap = kalahi_spending / pop07nso,
           total_spending_percap = total_spending / pop07nso,
           .before = general_fund)

# Merge in vote share data
dat <- election_returns |>
  group_by(region, mun) |> 
  filter(n() == 1) |> 
  ungroup() |> 
  right_join(dat, by = c("region", "mun")) |> 
  mutate(eightieth_margin = ifelse(vote_diff > .8, 1, 0),
         seventyfifth_margin = ifelse(vote_diff > .75, 1, 0),
         seventieth_margin = ifelse(vote_diff > .7, 1, 0),
         sixtyfifth_margin = ifelse(vote_diff > .65, 1, 0),
         sixtieth_margin = ifelse(vote_diff > .6, 1, 0),
         fiftyfifth_margin = ifelse(vote_diff > .55, 1, 0),
         fiftieth_margin = ifelse(vote_diff > .5, 1, 0),
         fortyfifth_margin = ifelse(vote_diff > .45, 1, 0),
         fortieth_margin = ifelse(vote_diff < .40, 1, 0),
         thirtyfifth_margin = ifelse(vote_diff < .35, 1, 0),
         thirtieth_margin = ifelse(vote_diff < .30, 1, 0),
         twentyfifth_margin = ifelse(vote_diff < .25, 1, 0),
         twentieth_margin = ifelse(vote_diff < .2, 1, 0),
         fifteenth_margin = ifelse(vote_diff < .15, 1, 0),
         tenth_margin = ifelse(vote_diff < .1, 1, 0),
         fifth_margin = ifelse(vote_diff < .05, 1, 0),
         marginal_margin = ifelse(vote_diff < .025, 1, 0),
         yolanda = ifelse(mun %in% yolanda &
                            (as.numeric(substr(quarter, 3, 6)) > 2013 |
                            quarter == "Q42013"), 1, 0),
         .before = treat) |> 
  mutate(
    post = ifelse(as.numeric(substr(quarter, 3, 6)) >= 2013, 1, 0),
    post_treat = treat * post,
    .before = treat)
```

\clearpage

```{r, echo = F, message = F, warning = F, include = F}
library(sf)

# Read shape file of municipalities
phl_munis <- st_read("Data/Municities/MuniCities.shp") |>
  rename(mun = NAME_2) |>
  group_by(mun) |>
  filter(n() == 1) |>
  ungroup()

# Merge evaluation data
dat_sf <- dat |> left_join(phl_munis, by = "mun") |> st_as_sf()

# Identify bordering controls (for spillover analysis)
adj_matrix <- st_touches(dat_sf, dat_sf)
bordering_control <- sapply(adj_matrix, function(neighbors) {
  any(dat_sf$treat[neighbors] == 1)
})

dat_sf <- dat_sf |> 
  mutate(border_treat = ifelse(treat == 0 & bordering_control, 1, 0))
```

```{r, echo = F, warning = F, message = F}
# --- Plot full map with outlines ---
ggplot() +
  # Base layer: all municipality outlines
  geom_sf(data = phl_munis, fill = "gray75", color = "white", size = 0.1) +
  
  # Overlay: evaluation sample
  geom_sf(data = dat_sf, aes(fill = factor(treat)), color = "gray40", size = 0.2) +
  
  # Colors for treated/control
  scale_fill_manual(
    values = c("0" = "#2C7BB6", "1" = "#D7191C"),
    labels = c("Control", "Treated")
  ) +
  
  labs(
    title = "Figure 1: Kalahi-CIDSS Evaluation Sample, Philippines",
    fill = "Treatment"
  ) +
  
  theme_void() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 11)
  )
```

\vfill

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width=8, fig.height=5, out.width='100%'}
# Evaluate pre-treatment trends

library(scales)
library(ggthemes)

# Function to process yearly budget reports (historic data only available yearly)
process_yearly <- function(file_path) {
  data <- read_excel(file_path)
  
  # Clean column names
  cleaned_column_names <- colnames(data) |> 
    str_to_lower() |> 
    str_replace_all(" ", "_") |> 
    str_replace_all("/", "_") |> 
    str_replace_all("[^a-z_]", "") |> 
    str_replace_all("_+", "_") |> 
    str_replace_all("social_security_social_services_welfare", "social_services_and_social_welfare")
  
  # Set the new column names
  cleaned_data <- setNames(data, cleaned_column_names) |> 
    filter(lgu_type == "Municipality") |> 
    select(-c(lgu_type)) |> 
    rename(mun = lgu_name)
  
  cleaned_data <- cleaned_data |> 
    mutate(across(4:ncol(cleaned_data), as.numeric)) |>
    mutate(year = str_match(file_path, "20[0-2][0-9]")[, 1],
           .after = mun) |> 
    mutate(region = str_replace_all(str_replace_all(region, "Region ", ""), " Region", "")) |>
    mutate(region = str_replace_all(region, "MIMAROPA", "IV-B")) |> 
        mutate(kalahi_spending = rowSums(across(c(education_culture_sports_manpower_development,
                                              health_nutrition_population_control,
                                              housing_and_community_development,
                                              social_services_and_social_welfare)),
                                     na.rm = TRUE),
          total_spending = ifelse(as.numeric(year) < 2009,
                                  total_expenditures,
                                  rowSums(across(c(total, total_current_operating_expenditures,
                                            total_nonoperating_expenditures)),
                                    na.rm = TRUE)),
           .after = year)
  
  if(str_detect(file_path, "200[1-8]")) {
    cleaned_data[, 5:ncol(cleaned_data)] <- cleaned_data[, 5:ncol(cleaned_data)] * 1e6
  }
  
  return(cleaned_data)
}

historic_dat <- process_yearly("Data/Yearly Spending/By-LGU-SRE-2007.xlsx") |>
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2008.xlsx")) |>
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2009.xlsx")) |>
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2010.xlsx")) |>
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2011.xlsx")) |> 
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2012.xlsx")) |>
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2013.xlsx")) |>
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2014.xlsx")) |> 
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2015.xlsx")) |> 
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2016.xlsx")) |> 
  bind_rows(process_yearly("Data/Yearly Spending/By-LGU-SRE-2017.xlsx"))

historic_dat <-
  read_csv("Data/KALAHI/PHL-KC Matching Data for Sample/matching data for sample.csv") |> 
  rename(region = reg_psgc, treat = treatment) |> 
  select(-c(island, mun_psgc, pairnum)) |> 
  mutate(yolanda = ifelse(mun %in% yolanda, 1, 0)) |> 
  group_by(region, mun) |> 
  filter(n() == 1) |> 
  ungroup() |> 
  full_join(historic_dat, by = c("region", "mun")) |> 
  filter(!is.na(treat) & !is.na(year))

historic_dat |>
  mutate(
    treat = factor(ifelse(treat == 1, "KALAHI municipalities", "Control municipalities")),
    year_num = as.numeric(year)
  ) |>
  ggplot(aes(x = year_num, y = total_spending / pop07nso, color = treat, fill = treat)) +
  stat_summary(fun = mean, geom = "line", size = 1.3) +
  geom_vline(xintercept = 2011, linetype = "dashed", color = "gray50", size = 0.9) +
  annotate("text", x = 2011, y = 3200, label = "Program rollout", 
           hjust = 0, vjust = -0.3, angle = 90, size = 3, color = "gray50") +
  scale_color_manual(values = c("#2C7BB6", "#D7191C")) +
  scale_fill_manual(values = c(alpha("#2C7BB6", 0.2), alpha("#D7191C", 0.2))) +
  scale_y_continuous(labels = label_comma()) +
  scale_x_continuous(breaks = 2007:2017) +
  labs(
    x = "Year", 
    y = "Per capita spending (PhP)",
    title = "Figure 2: Trends in municipal spending: KALAHI vs control municipalities",
    subtitle = "Spending per capita, 2007–2017; dashed line indicates program rollout",
    color = NULL,
    fill = NULL,
    caption = "Notes: Average municipal spending from Bureau of Local Government Fiannce data."
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold"),
    plot.subtitle = element_text(size = 10),
    legend.position = "bottom",
    panel.grid.minor = element_blank()
  )
```

\clearpage

# 4 Results

I estimate the causal effect of Kalahi-CIDSS on public spending with the following equation:

$$
y_{irt} = \tau D_{i} + X_{irt} + \epsilon_{rt}
$$

where $y_{it}$ represents per capita spending in municipality $i$ at quarter $t$ and $D_i$ is an indicator for Kalahi-CIDSS treatment. The coefficient $\tau$ captures the average treatment effect on municipal spending, while $X_{irt}$ denotes a vector of unit-specific controls, including region and time fixed effects. The remaining term accounts for error.

Table 1 presents the effect of Kalahi-CIDSS on municipal public service spending. The program significantly reduced public service spending in recipient municipalities ($p<.001$). The magnitude of this effect is economically meaningful: quarterly per capita public service spending declined by about PhP 248 (roughly \$4). For the median municipal population[^5], this amounts to a reduction of about 28 million pesos yearly, or \$500,000. These results provide clear evidence that Kalahi-CIDSS induced local governments to cut back on their own public service provision.

[^5]: The median municipal population in the Kalahi-CIDSS impact evaluation sample is 28,267.

This reduction in public service spending was not offset by increases elsewhere in the municipal budget. The estimated effect of Kalahi-CIDSS on total per capita spending across all spending categories is only slightly smaller than the effect on public service expenditures. This near equivalence indicates that municipalities did not efficiently reallocate funds to other domains in response to the program. Rather, aid appears to have displaced total municipal expenditure.

A potential concern in program evaluation is that control municipalities bordering treated areas may indirectly benefit from spillovers, such as through interjurisdictional learning, shared infrastructure, or political signaling effects. To account for this, I re-estimate the baseline model including an indicator for control municipalities which border treated municipalities. This specification identifies the direct treatment effect while adjusting for potential indirect exposure to the program.

The results indicate that municipalities that receive the grant spend significantly less from their own budgets in program-relevant categories, even after adjusting for spillovers. Control municipalities which border treatment municipalities show slightly higher spending levels, suggesting modest positive spillovers, possibly due to complementary investments or political imitation effects by neighboring local governments. The mild evidence of positive spillovers in adjacent municipalities further reinforces that the main effect reflects genuine fiscal substitution by treated localities rather than regional budget displacement.

As a placebo test, I examine transfers from the national government, which are exogenous to local fiscal discretion. Since these allocations are determined centrally, they should be unaffected by municipal decisions or crowd-out dynamics. Consistent with this expectation, the estimated treatment effect is small and statistically insignificant. This reinforces the interpretation that observed reductions in public service spending stem from local fiscal substitution rather than broader macro-fiscal changes.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
base_kalahi <- lm_robust(kalahi_spending_percap ~ treat + yolanda + I(pop07nso / 1000) + land + pi +
                           bgytot + as.factor(region) + as.factor(quarter), dat)
base_total <- lm_robust(total_spending_percap ~ treat + yolanda + I(pop07nso / 1000) + pi + land + bgytot +
                     as.factor(region) + as.factor(quarter), dat)
natl_sources <- lm_robust(I(other_shares_from_national_tax_collections / pop07nso) ~ treat + yolanda +
                            I(pop07nso / 1000) + pi + land + bgytot +
                  as.factor(region) + as.factor(quarter) + pi, dat)

# Re-run analysis accounting for spillovers
kalahi_spill <- lm_robust(kalahi_spending_percap ~ treat + border_treat + yolanda + pi +
                                 I(pop07nso / 1000) + as.factor(region) + as.factor(quarter), dat_sf)
total_spill <- lm_robust(total_spending_percap ~ treat + border_treat + pi +
            yolanda + I(pop07nso / 1000) + as.factor(region)
            + as.factor(quarter), dat_sf)

modelsummary(list("Public services" = base_kalahi,
                  "Total" = base_total,
                  "Public services" = kalahi_spill,
                  "Total" = total_spill,
                  "National gov financing" = natl_sources),
             coef_map = c(
               "treat" = "treat",
               "border_treat" = "borders treatment",
               "yolanda" = "yolanda",
               "I(pop07nso/1000)" = "population",
               "pi" = "poverty incidence",
               "land" = "land area",
               "bgytot" = "num barangays"
             ),
             stars = T,
             title = "Effect of Kalahi on public spending",
             output = "kableExtra") |>
  kable_classic(latex_options = "scale_down") |> 
  kable_styling(full_width = FALSE, position = "center") |> 
  footnote(general = "Spending measured in Philippine pesos. Population covariate scaled per 1,000 people
  such that significant digits are visible in the parameter estimate. Models include region and
  quarter-fixed effects.", threeparttable = TRUE, escape = FALSE, footnote_as_chunk = TRUE)
```

## Political competition dampens crowd-out

The preceding results reveal an average crowd-out effect, but theory predicts that the magnitude of this effect should vary across political environments. Specifically, if politicians in competitive districts face stronger incentives to maintain visible public service provision, then crowd-out should be less pronounced where electoral competition is high. Here I present evidence that political competition determines how politicians respond to development assistance.

Figure 3 illustrates this moderating relationship descriptively by plotting public service spending against mayoral margin of victory by treatment assignment, with fitted LOESS regressions overlaid. Margin of victory pertains to the 2013 local elections, the contest immediately preceding the intervention. Treated municipalities show a marked decline in spending as margins of victory increase. That is, as elections become less competitive, politicians appear to roll back spending significantly in response to Kalahi-CIDSS.

To test this rigorously, I estimate interaction models that include the treatment indicator and the mayoral margin of victory. Results are presented in Table 2. The coefficient on the interaction term is negative and statistically significant, indicating that Kalahi-CIDSS reduced public spending primarily in low-competition municipalities. In competitive jurisdictions, incumbents increased spending levels, consistent with the theoretical expectation that electoral pressure constrains fiscal substitution.

These results are robust to alternative measures of competition. Results using binary indicators of political competition are included in the appendix in Table A2. The estimated interaction effects remain consistent in sign and significance. Across specifications, the findings suggest that where politicians face little threat of electoral turnover, Kalahi-CIDSS crowds out local government spending. Where they face close contests, grants do not.

Given that political competition is not randomly assigned, I investigate additional plausible explanations for these findings to verify that results do not derive from political dynamics correlated with competition. In particular, I include a dummy indicator for political dynasties, a salient feature of Philippine politics known to hamper competition. Model (1) in Table 2 displays results with the same set of municipal-level controls as Table 1, while model (2) incorporates the full set of additional political controls. The magnitude and sign of parameter estimates remain similar.

To further investigate the mechanisms through which political competition hampers crowd-out, I explore the fiscal behavior of term-limited mayors who lack reelection incentives. In the Philippines, mayors are constitutionally limited to three consecutive terms. Term-limited mayors in 2013, having already served two prior terms, could not seek reelection and thus faced weaker electoral accountability. If political competition disciplines incumbents primarily through reelection concerns, then the moderating effect of competition should disappear when incumbents are term-limited.

To test this, I estimate a triple interaction model with Kalahi-CIDSS treatment, margin of victory, and an indicator for whether the mayor was term limited. The results are shown in model (3) and support the hypothesized mechanism. Among incumbents eligible for reelection, competition strongly constrains fiscal substitution. However, the triple interaction between treatment, vote margin, and term limits is positive and significant ($\beta = 8,724$, $p < 0.001$), demonstrating that this competition effect disappears when incumbents cannot run again. This pattern suggests that reelection incentives are the channel through which political competition disciplines fiscal behavior. When incumbents’ electoral futures are no longer at stake, competitive pressure ceases to moderate the fiscal response to aid.

In addition, I examine the behavior of mayors from political dynasties, which enjoy entrenched power and insulation from electoral pressure. Dynastic politicians often possess durable networks of patronage, control over local party machinery, and name recognition, all of which should reduce the disciplining effect of competition. As such, I include a specification (model 4) with a triple interaction between treatment, margin of victory, and a dynasty indicator. Again, I derive a positive and significant parameter estimate ($\beta = 6,182$, $p < 0.001$), indicating that reelection incentives are the mechanism by which competition moderates crowd-out.

\hspace{40 mm}

```{r, echo = FALSE, message = FALSE, warning = FALSE,fig.width=9, fig.height=6, out.width='100%'}
dat |>
  mutate(
    treat = factor(ifelse(treat == 1, "KALAHI municipalities", "Control municipalities"))) |>
  ggplot(aes(x = vote_diff, y = kalahi_spending_percap, color = treat)) +
  geom_point(alpha = 0.2, size = 1) +
  geom_smooth(method = "loess", se = TRUE, size = 1.2, span = 0.8) +
  scale_color_manual(values = c("#2C7BB6", "#D7191C")) +
  labs(
    x = "Margin of victory",
    y = "Per capita public service spending (PhP)",
    title = "Figure 3: Political competition moderates the effect of NGO presence on spending",
    subtitle = "Smoothed relationship between electoral competitiveness and per capita service spending",
    color = NULL,
    caption = "Note: Smaller margins of victory indicate higher competition."
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold"),
    plot.subtitle = element_text(size = 10),
    legend.position = "bottom",
    panel.grid.minor = element_blank()
  )
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Add term-limited indicator
term_limited <- c("La Paz", "Langiden", "Luba", "Malibcong", "San Juan",
                  "Kapalong", "Lopez", "Quezon", "Real", "Bansud", "Balabac", "Culion",
                  "Banton", "Calatrava", "Romblon", "Paracale", "Cabusao", "Goa", "Ragay", "Tigaon",
                  "Tinambac", "Gigmoto", "San Miguel", "Cataingan", "Prieto Diaz", "New Washington",
                  "Tangalan", "Bugasong", "Arteche", "Dolores", "General Macarthur", "Quinapondan",
                  "Alangalang", "Babatngon", "Barugo", "Burauen", "Jaro", "Lavezares", "Dumalinao",
                  "Tambulig", "Ipil", "Naga", "Talusan")
dat <- dat |> mutate(term_limited = ifelse(mun %in% term_limited, 1, 0), .before = vote_diff)

# Add dynasty indicator
dynasties <- read_excel("Data/ASoG-POLITICAL-DYNASTIES-DATASET-V2016.xlsx", sheet = "Data") |> 
  rename(mun = Municipality.City, first_name = 'First Name', last_name = 'Last Name') |> 
  mutate(mun = str_to_title(mun)) |> 
  filter(Year == 2013) |> 
  select(first_name, last_name, fat) |> 
  right_join(dat |> mutate(last_name = str_match(winner, "^([^,]+),")[,2],
                           first_name = str_match(winner, ",\\s(.*?)\\s\\(")[,2]),
             by = c("last_name", "first_name")) |> 
  select(-c(first_name, last_name))

kalahi_comp <- lm_robust(kalahi_spending_percap ~ treat * vote_diff + yolanda + I(pop07nso / 1000) + pi +
                           land + bgytot + as.factor(region) + as.factor(quarter), dat)
kalahi_comp_full <- lm_robust(kalahi_spending_percap ~ treat * vote_diff + yolanda + I(pop07nso / 1000) +
                                pi + land + fat + bgytot + as.factor(region) + as.factor(quarter),
                              dynasties)
kalahi_term <- lm_robust(kalahi_spending_percap ~ treat * vote_diff * term_limited + yolanda + fat +
                    I(pop07nso / 1000) + pi + land + bgytot + as.factor(region) + as.factor(quarter),
                  dynasties)
kalahi_dynasty <- lm_robust(kalahi_spending_percap ~ treat * vote_diff * fat + yolanda +
                    I(pop07nso / 1000) + pi + land + bgytot + as.factor(region) + as.factor(quarter),
                  dynasties)

modelsummary(list("(1)" = kalahi_comp,
                  "(2)" = kalahi_comp_full,
                  "(3)" = kalahi_term,
                  "(4)" = kalahi_dynasty),
             stars = T,
             title = "Effect of Kalahi on public service spending by electoral competitiveness",
             coef_map = c(
               "treat" = "treat",
               "vote_diff" = "margin of victory",
               "treat:vote_diff" = "treat x margin of victory",
               "treat:vote_diff:term_limited" = "treat x margix of victory x term limited",
               "treat:vote_diff:fat" = "treat x margin of victory x dynasty",
               "fat" = "dynasty",
               "yolanda" = "yolanda",
               "I(pop07nso/1000)" = "population",
               "pi" = "poverty incidence",
               "land" = "land area",
               "bgytot" = "num barangays"
             ),
             output = "kableExtra"
             ) |> kable_classic(latex_options = "scale_down") |> 
  kable_styling(full_width = FALSE, position = "center") |> 
  footnote(general = "Spending measured per capita in Philippine pesos.
  Models include region and quarter-level fixed effects, as well as the full range of municipal demographic
  and political covariates.",
  threeparttable = TRUE,
  escape = FALSE, footnote_as_chunk = TRUE)
```

```{r, include = F}
# Marginal effect plot - ask Cesi if needed

# 1. Build a grid of values for the independent variables of interest
# Replace `dynasties` with the actual dataset you used to estimate the model
newdata <- expand.grid(
  vote_diff = seq(min(dynasties$vote_diff, na.rm = TRUE),
                  max(dynasties$vote_diff, na.rm = TRUE),
                  length.out = 100),
  treat = c(0, 1)
)

# 2. Keep other covariates at their mean (or modal) values
# (important so predictions reflect an 'average' municipality)
mean_vals <- dynasties %>%
  summarise(
    yolanda = mean(yolanda, na.rm = TRUE),
    pop07nso = mean(pop07nso, na.rm = TRUE),
    pi = mean(pi, na.rm = TRUE),
    land = mean(land, na.rm = TRUE),
    bgytot = mean(bgytot, na.rm = TRUE),
    region = names(sort(table(region), decreasing = TRUE))[1],
    quarter = names(sort(table(quarter), decreasing = TRUE))[1],
    fat = mean(fat, na.rm = TRUE)  # optional if your model includes it
  )

# 3. Merge mean covariates into newdata
newdata <- cbind(newdata, mean_vals[rep(1, nrow(newdata)), ])

# 4. Get predicted values and standard errors
pred <- predict(kalahi_comp, newdata = newdata, se.fit = TRUE)

# 5. Combine predictions into one dataframe
preds <- newdata %>%
  mutate(
    fit = pred$fit,
    se = pred$se.fit,
    upper = fit + 1.96 * se,
    lower = fit - 1.96 * se,
    treat = factor(treat, labels = c("Control", "Treatment"))
  )

# 6. Plot: Marginal effect of competition on predicted spending
ggplot(preds, aes(x = vote_diff, y = fit, color = treat, fill = treat)) +
  geom_line(size = 1.2) +
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.15, color = NA) +
  labs(
    title = "Marginal effect of political competition on spending by treatment",
    subtitle = "Predicted per capita spending by margin of victory and program exposure",
    x = "Margin of victory (competition)",
    y = "Predicted per capita spending",
    color = "Treatment",
    fill = "Treatment"
  ) +
  scale_color_manual(values = c("#1b9e77", "#d95f02")) +
  scale_fill_manual(values = c("#1b9e77", "#d95f02")) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "bottom",
    plot.title = element_text(face = "bold"),
    panel.grid.minor = element_blank()
  ) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "gray40") +
  annotate("text", x = 0, y = max(preds$upper, na.rm = TRUE),
           label = "High competition", vjust = -0.5, hjust = -0.1,
           color = "gray40", size = 3)
```

\clearpage

# 5 Crowd-out harms human welfare

While fungibility itself presents a concern for development policymakers who wish for aid to finance its intended programs, it does not always harm human development. Governments may allocate freed funds efficiently in order to address pressing domestic needs and optimize resources (@feyzioglu1996), and empirical evidence shows that aid fungibility does not necessarily reduce child mortality, particularly under strong democratic institutions (@pettersson2007). I exploit an exogenous shock to local public financing during the impact evaluation of Kalahi-CIDSS to evaluate whether crowd-out bore consequences for human welfare.

The key source of identifying variation is a delay in the release of all national financing to local governments in the year 2013. The Internal Revenue Allotment (IRA) constitutes roughly 80 percent of the operating income of municipalities and was delayed by the Department of Budget and Management, which routed funds through their local offices rather than to municipalities directly, as required by law. The Commission on Audit of the Philippines declared the move unconstitutional and cannot account for nearly half of the IRA for that year. The scandal was widely reported in prominent domestic news outlets in the Philippines.

As a result of the delay, municipalities experienced an exogenous liquidity shock at the same time that Kalahi-CIDSS community development grants were disbursed in full. This provides quasi-experimental variation in the fiscal environment during program implementation: all municipalities were exposed to the same exogenous national-level shock, but only treated municipalities simultaneously received Kalahi funds, creating an opportunity to identify whether crowd-out moderated the program’s welfare impact.

To assess whether fiscal crowd-out attenuated the welfare effects of Kalahi-CIDSS, I estimate a difference-in-differences model using household-level data from the program’s impact evaluation. The estimation compares treated and control municipalities across the midline (2014) and endline (2015) surveys. The outcome is a standardized composite index of infrastructure-related welfare outcomes scaled so that higher values indicate improved access. I focus on infrastructure as this was the most common use of funds and the only welfare module common to both midline and endline surveys, allowing me to compare the same outcomes over time.

Formally, I estimate:

$$
welfare_{irt} = \tau D_{i} + post_t + D_{i}*post_t + X_{irt} + \epsilon_{rt}
$$

where $welfare_{irt}$ denotes the household's welfare index, $D_i$ indicates assignment to Kalahi, and $post_t$ equals 1 in the endline period. The interaction term captures the difference in welfare improvements between treated and control municipalities before and after the IRA shock.

Results, presented in Table 3, show that while Kalahi treatment is associated with large and significant welfare improvements at midline ($\beta=0.215$, $p<0.001$), the interaction term was negative and significant ($\beta=-0.072$, $p=.017$). This pattern indicates that welfare gains in treated municipalities were roughly 0.07 standard deviations smaller at endline in the absence of the fiscal shock. The direction and magnitude of the estimate are consistent with the hypothesized crowd-out channel. The liquidity shortfall caused by the delayed IRA release appears to have led LGUs to scale back local spending, reducing the overall welfare benefits of the Kalahi-CIDSS grants.

Control variables behave as expected. Population and land area are strong predictors of baseline infrastructure access, while exposure to Typhoon Yolanda shows no significant association with welfare outcomes, suggesting that regional recovery dynamics are unlikely to confound the treatment effect. The coefficient on non-compliance is negative and marginally significant, consistent with reduced program effectiveness in municipalities that failed to implement Kalahi as designed.

Substantively, these results imply that Kalahi-CIDSS’s overall positive effect on access to local infrastructure was partially offset by fiscal responses from local governments. The findings highlight the importance of considering the political context in evaluating development programs. External assistance can generate perverse incentives for local co-financing. The 2013 IRA delay provides a rare natural experiment that exposes these dynamics, showing that even well-designed, community-driven programs may yield muted welfare returns when they inadvertently displace public resources.

```{r, message = F, warning = F, echo = F}
library(haven)
library(interflex)
library(rlang)

# Helper function to standardize vars
standardize <- function(data, vars) {
  # If user passes bare names, capture them
  if (is_symbol(vars) || is_call(vars)) {
    vars <- as.character(ensyms(vars))
  }
  # If user passes character vector, leave as is
  else if (is.character(vars)) {
    vars <- vars
  } else {
    stop("`vars` must be bare variable names or a character vector of names.")
  }
  
  for (var_name in vars) {
    if (!var_name %in% names(data)) {
      warning(paste("Variable", var_name, "not found in data. Skipping."))
      next
    }
    
    mu <- mean(data[[var_name]], na.rm = TRUE)
    sigma <- sd(data[[var_name]], na.rm = TRUE)
    
    if (is.na(sigma) || sigma == 0) {
      warning(paste("Variable", var_name, "has zero or undefined SD. Returning zeros."))
      data[[var_name]] <- 0
    } else {
      data[[var_name]] <- (data[[var_name]] - mu) / sigma
    }
  }
  
  return(data)
}

# Load matching variables for household surveys
interim_details <- read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/Interim Details on Full Sample 198 Sample v5.dta")

# Merge with covariates
analysis_match <- read_csv("Data/KALAHI/PHL-KC Matching Data for Sample/matching data for sample.csv") |>
  rename(region = reg_psgc) |> 
  dplyr::select(-c(island)) |> 
  mutate(yolanda = ifelse(mun %in% yolanda, 1, 0)) |> 
  left_join(interim_details[,-4], by = c("pairnum", "treatment")) |> 
  rename(treat = treatment) |> 
  dplyr::select(-c(treatmen))

# Merge in vote share data
analysis_match <- dat |>
  mutate(percent_ira = internal_revenue_allotment / total_current_operating_income) |> 
    dplyr::select(c(region, mun, vote_share, vote_diff,
           kalahi_spending_percap, total_spending_percap, percent_ira)) |> 
  distinct(region, mun, .keep_all = T) |> 
  right_join(analysis_match, by = c("region", "mun")) |> 
  mutate(mun = as.factor(mun))

## Read in human welfare data, merge with municipal covariates, and clean
# Hardship
hardship <-
  read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_H8_Hardship_HH_AnalysisVarsB.dta") |>
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(across(de1_death:DE5_96B, \(x) ifelse(x == -95, NA, x))) |>  # Recode missing vals to NA
  mutate(assistance = rowSums(across(c(de6_death_finass_a, de6_ill_finass_a, de6_job_finass_a, de6_calam_finass_a,
           de6_noharv_finass_a, de6_van_finass_a)), na.rm = T),
         asked_lgu = ifelse((de4_death_helpLguOff == 1) | (de4_illness_helpLguOff == 1) | (de4_jobless_helpLguOff == 1)
                            | (de4_calamity_helpLguOff) == 1 | (de4_noharvest_helpLguOff) == 1 |
                              (de4_vandal_helpLguOff) == 1, 1, 0)) |> 
  standardize(c("assistance", "asked_lgu"))

# Fishing
fish <-
  read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_Hypothesis_1c_FA_HH_AnalysisVarsA.dta") |> 
  left_join(analysis_match, by = "lk4") |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(across(fish1:fyp4p_5, \(x) ifelse(x == -95, NA, x))) |>
  mutate(qty_fish_sold = rowSums(across(matches("fyp4a_[1-9]")), na.rm = T),
         price_fish_sold = rowSums(across(matches("fyp4d_[1-9]")), na.rm = T),
         qty_aquaculture_sold = rowSums(across(matches("fyp4q_[1-9]")), na.rm = T),
         price_aquaculture_sold = rowSums(across(matches("fyp4p_[1-9]")), na.rm = T)) |> 
  standardize(c("qty_fish_sold", "price_fish_sold", "qty_aquaculture_sold", "price_aquaculture_sold"))

# Agriculture
agri <-
  read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_Hypothesis_1c_Agri_HH_AnalysisVarsA.dta") |> 
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(across(crop1:ag18a_d22, \(x) ifelse(x == -95, NA, x))) |>
  mutate(area_planted = rowSums(across(matches("ag17a_[1-9]|ag6s_[1-9]|ag17h")), na.rm = T),
         qty_harvest = rowSums(across(matches("ag18a|ag7a")), na.rm = T),
         qty_harvest_sold = rowSums(across(matches("ag19a1_[1-9]")), na.rm = T)) |> 
  standardize(c("area_planted", "qty_harvest", "qty_harvest_sold"))

# Employment
labor <- read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_LT2_Labor_HH-AnalysisVarsB.dta") |> 
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(across(lm2:lm13, \(x) ifelse(x == -95, NA, x))) |> 
  rename(income = lm9, work_hrs = lm11, hrs_worked_last_wk = lm13) |> 
  standardize("income")

# Spending
spending <- read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_LT1_AnalysisVarsB.dta") |> 
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(across(fuel1:tobacco_2, \(x) ifelse(x == -95, NA, x))) |>
  mutate(hh_spending = rowSums(across(matches("1$")), na.rm = T),
         hh_produce = rowSums(across(matches("2$")), na.rm = T)) |> 
  standardize(c("hh_spending", "hh_produce"))

# Education (Null effects)
edu <- read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_Hypothesis_1e_AnalysisVarsB.dta") |> 
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(num_teachers = rowSums(across(matches("teacher")), na.rm = T),
         num_schools = rowSums(across(c(edf_public_elem, edf_public_sec)), na.rm = T),
         enrollment = rowSums(across(matches("enrolled")), na.rm = T)) |> 
  standardize(c("num_teachers", "num_schools", "enrollment"))

# Infrastructure (sign of analysis vars flipped as Kalahi intended to lower outcomes)
infra <- read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_Hypothesis_1a_AnalysisVarsA.dta") |> 
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(dist_pub_services = rowSums(across(matches("acs1_m")), na.rm = T),
         travel_time = rowSums(across(matches("acs3")), na.rm = T),
         travel_cost = rowSums(across(matches("acs4")), na.rm = T)) |> 
  standardize(c("dist_pub_services", "travel_time", "travel_cost")) |> 
  mutate(dist_pub_services = -1 * dist_pub_services,
         travel_time = -1 * travel_time,
         travel_cost = -1 * travel_cost)

# Water (sign of analysis vars flipped as Kalahi intended to lower outcomes)
water <- read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_Hypothesis_1h_AnalysisVarsA.dta") |> 
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(across(ws2_d:ws13_r, \(x) ifelse(x == -95, NA, x))) |> 
  mutate(amnt_paid = ws12_r + ws12_d,
         time_spent = ws8_r + ws8_d,
         num_trips = ws9_dt + ws9_rt) |> 
  standardize(c("amnt_paid", "time_spent", "num_trips")) |> 
  mutate(amnt_paid = -1 * amnt_paid,
         time_spent = -1 * time_spent,
         num_trips = -1 * num_trips)

# Household (don't use)
household <- read_dta("Data/KALAHI/Endline Public Use Data Package/Datasets/3rdRnd_LT1_AnalysisVarsC.dta") |> 
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  rename(floor_area = ham4_m, num_rooms = ham5, elec = ham7) |> 
  mutate(elec = as.numeric(elec), floor_area = as.numeric(floor_area)) |> 
  standardize(c("floor_area", "elec", "num_rooms"))

# To incorporate all welfare outcomes
# endline <- infra |>
#   full_join(labor) |> 
#   full_join(spending) |> 
#   full_join(water) |> 
#   full_join(hardship) |> 
#   full_join(fish) |> 
#   full_join(edu) |> 
#   full_join(agri) |> 
#   mutate(humdev =
#            rowMeans(across(c(assistance, asked_lgu, qty_fish_sold, price_fish_sold, qty_aquaculture_sold, 
#                              price_aquaculture_sold, area_planted, qty_harvest, qty_harvest_sold, income,
#                              hh_spending, hh_produce, num_teachers, num_schools, enrollment, dist_pub_services,
#                              travel_time, travel_cost, amnt_paid, time_spent, num_trips)),
#                     na.rm = TRUE),
#          post_2013 = 1,
#          .after = "hh_id_psgc")

# Only w infra as midline only contains those vars
endline <- infra |>
  mutate(humdev = rowMeans(across(c(dist_pub_services, travel_time, travel_cost)), na.rm = TRUE),
         post_2013 = 1,
         .after = "hh_id_psgc")

## Read in midline welfare vars
midline <- read_dta("Data/KALAHI/Interim Public Use Data Package (3)/Data/Interim_H1_AnalysisVars_INT.dta") |> 
  left_join(analysis_match, by = c("lk4")) |> 
  dplyr::select(!matches("\\.x|\\.y")) |> 
  mutate(dist_pub_services = -1 * rowSums(across(matches("acs1_m")), na.rm = T),
         travel_time = -1 * rowSums(across(matches("acs3")), na.rm = T),
         travel_cost = -1 * rowSums(across(matches("acs4")), na.rm = T)) |> 
  standardize(c("dist_pub_services", "travel_time", "travel_cost")) |> 
  mutate(humdev = rowMeans(across(c(dist_pub_services, travel_time, travel_cost))),
         post_2013 = 0)

ie_surveys <- endline |> full_join(midline)

# DiD models
welfare_did <- lm(
  humdev ~ treat * post_2013 + pop07nso + pi + land + yolanda + non_complier,
  data = ie_surveys
)

modelsummary(list("Infrastructure" = welfare_did),
             coef_map = c(
               "treat" = "treat",
               "post_2013" = "post-2013",
               "treat:post_2013" = "treat * post-2013",
               "yolanda" = "yolanda",
               "I(pop07nso/1000)" = "population",
               "pi" = "poverty incidence",
               "land" = "land area",
               "bgytot" = "num barangays"
             ),
             stars = T,
             title = "Effect of local financing on welfare gains",
             output = "kableExtra") |>
  kable_classic(latex_options = "hold_position") |> 
  kable_styling(full_width = FALSE, position = "center") |> 
  footnote(general = "Infrastructure outcomes in standard units. Population covariate scaled per 1,000 people
  such that significant digits are visible in the parameter estimate.", threeparttable = TRUE, escape = FALSE, footnote_as_chunk = TRUE)
```

# 6 Broader Budget Allocation

A central question in the political economy of aid is whether externally-funded programs merely crowd out local service provision or whether they induce broader reallocations of government spending. I explore this question by examining whether Kalahi-CIDSS affected the structure of municipal budgets beyond the direct substitution effects documented earlier. If politicians simply reduced spending in Kalahi-related line items, then the remaining portions of the budget should be statistically unrelated to treatment. However, if the program reshaped broader fiscal priorities, then other budget categories should also help to predict treatment status.

To evaluate this, I employ a supervised machine learning approach that leverages the flexibility of random forests to uncover high-dimensional relationships in budgetary data. Following the logic of @mullainathan2017, who argue that machine learning provides a powerful complement to traditional econometric inference by revealing patterns that are difficult to specify a priori, I use predictive modeling not for causal estimation but to assess whether treatment status is encoded in the overall structure of local budgets. Specifically, I fit nested random forest models to predict treatment assignment using only Kalahi-related budget categories and then the entire set of municipal budget variables. The random forest algorithm constructs multiple classification trees based on random subsamples of the data and aggregates out-of-bag (OOB) predictions to evaluate performance on unseen observations (@breiman2001). I fit 100 limited and 100 full models, using a bootstrap procedure to compare the distribution of OOB error rates across specifications. This approach tests whether the model trained on the full budget predicts treatment significantly better than one trained only on Kalahi-related categories.

This strategy builds upon an econometric literature using machine learning in political economy to illuminate complex, structural relationships within institutional data (@athey2019). Whereas traditional parametric models impose strong functional form assumptions and risk overlooking nonlinearities or interactions, the random forest framework flexibly captures such patterns, allowing me to test whether program exposure is embedded in latent fiscal configurations that would be difficult to identify otherwise.

As a falsification exercise, I also fit identical random forests to predict (1) exposure to Typhoon Yolanda—an exogenous determinant of fiscal variation—and (2) a random binary variable. If the algorithm can predict Yolanda damage but not a random variable, then successful prediction of Kalahi-CIDSS treatment reflects systematic budgetary differences rather than overfitting. Results from this exercise are shown in appendix Figure A1. As expected, models predict Yolanda exposure better than chance, while random variables yield near-random performance.

I conduct a t-test to compare the OOB rate between the nested and full models. Random forests trained on the full budget significantly outperform those restricted to Kalahi-related categories, with a p-value of 1.287e-139, suggesting that treatment status is encoded in broader budget structures. These findings imply that Kalahi-CIDSS not only substituted for local public service spending but also influenced broader fiscal behavior.

\hspace{40 mm}

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide', eval = FALSE}
# Compare model fit to explore effects of treatment on budget

set.seed(252463)

# Code a random variable
dat <- dat |> mutate(random = sample(c(0, 1), nrow(dat), replace = TRUE))

# Fit many random forests on limited vs full budget and compare model fit
grow_forest <- function() {
  
  # Remove all other covariates from budget data and impute missing values
  trimmed <- dat |> filter(is.na(treat) == FALSE) |> select(append(budget_items, c("treat", "yolanda", "random")))
  imputed <- rfImpute(treat ~ ., data = trimmed)

  # Fit models to see if can predict treatment or covariates from budget
  kalahi_forest <- randomForest(as.factor(treat) ~ education_culture_sports_manpower_development +
                                  health_nutrition_population_control + housing_and_community_development
                                + social_services_and_social_welfare,
                       data = imputed |> select(!c(yolanda, random)))
  full_forest <- randomForest(as.factor(treat) ~ ., data = imputed |> select(!c(yolanda, random)))
  yolanda_forest <- randomForest(as.factor(yolanda) ~ ., data = imputed |> select(!c(treat, random)))
  random_forest <- randomForest(as.factor(random) ~ ., data = imputed |> select(!c(treat, yolanda)))
  
  # Return df of OOB error rates
  return(data.frame(
    kalahi = as.numeric(kalahi_forest$err.rate[nrow(kalahi_forest$err.rate), "OOB"][1]),
    full = as.numeric(full_forest$err.rate[nrow(full_forest$err.rate), "OOB"][1]),
    yolanda = as.numeric(yolanda_forest$err.rate[nrow(yolanda_forest$err.rate), "OOB"][1]),
    random = as.numeric(random_forest$err.rate[nrow(random_forest$err.rate), "OOB"][1])))
}

# Make many forests
res <- map_dfr(1:100, ~ grow_forest())
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, include = FALSE}
# Comparing out of bag error rates statistically

# Read in res from machine
res <- read_csv("Data/res.csv")

data.frame(
  Models = c("Yolanda vs random guessing", "Kalahi vs random guessing", "Kalahi vs full"),
  p = c(scientific(t.test(res$yolanda, rep(.5, length(res$yolanda)))$p.value, digits = 4),
        scientific(t.test(res$kalahi, rep(.5, length(res$kalahi)))$p.value, digits = 4),
        scientific(t.test(res$full, res$kahali)$p.value, digits = 4))) |>
  kable(format = "latex", booktabs = TRUE, digits = 4,
        caption = "Comparison of model fit") |> 
  kable_styling(font_size = 8)
```

\hspace{40 mm}

\clearpage

## Funds may be redirected to political supporters

To identify which budget components most differentiate treated municipalities, Table 4 reports the mean decrease in accuracy, a standard variable importance measure in random forests, across all budget categories. Several patterns emerge. Predictive power is highest for housing and community development, consistent with Kalahi-CIDSS’s project portfolio. Tax revenue also ranks among the top predictors, which supports prior empirical work finding that fungible aid depresses local taxation by reducing politicians’ need to raise revenue domestically (@pack1993).

Discretionary spending categories, such as “other general income” and “other receipts,” also rank highly in predictive importance. These broad budget lines are less tightly regulated and offer politicians substantial flexibility in disbursement. Their association with treatment suggests that Kalahi-CIDSS may have indirectly expanded fiscal space for discretionary resources that can be more readily politicized. This interpretation aligns with prior accounts of “soft” funds facilitating corruption and clientelism in the Philippines (@yilmaz2013).

To probe this question mechanism more directly, I incorporate quarterly data from the Philippine Labor Force Survey (LFS), which records individual employment status by sector and contract type. State employment, particularly short-term and contractual appointments, is widely recognized as a channel of political patronage, allowing local executives to reward supporters or mobilize electoral loyalty (@mccoy2009; @robinson2013; @colonnelli2020). If mayors redirected fungible resources to politically advantageous employment, then short-term government hiring should increase in treated municipalities.

I estimate a logistic regression predicting the probability that a respondent reports short-term government employment, controlling for respondent demographic covariates (age, gender) and the same municipal characteristics employed in my main specifications. As shown in Table 5, individuals in treated municipalities exhibit substantially higher odds of casual government employment ($β = 4.28$, $p < 0.01$). While this evidence is not definitive of patronage, as contractual hiring could also reflect legitimate implementation needs, it is consistent with politicians exploiting funds freed by Kalahi-CIDSS to expand patronage appointments. Complementing this pattern, municipal budgets show a significant decline in local tax revenue following treatment ($β = –58.69$, $p < 0.01$), reinforcing that aid-financed programs reduce the incentive to mobilize public revenues.

While these exploratory analyses cannot conclusively establish causal mechanisms, they underscore a broader implication. Even community-driven development programs may indirectly shape local governance. Future research should examine whether fungible aid enables politicians to redistribute fiscal resources in politically strategic and inefficient ways, such as clientelistic hiring, discretionary transfers, or corruption. Such dynamics may lead external development assistance to hamper local state capacity. These questions are fruitful avenues for further inquiry.

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "hide"}
set.seed(252463)

# Get list of budget categories for subsequent random forest analysis
budget_items <- process_quarterly("Data/Quarterly Spending/SRE-QTR-2013.xlsx", sheet = "Q32013") |> 
  select(-c(province, region, mun, quarter, year, kalahi_spending, total_spending)) |> 
  colnames()

trimmed <- dat |> filter(is.na(treat) == FALSE) |>
                              select(append(budget_items, c("treat")))
imputed <- rfImpute(treat ~ ., data = trimmed)

# Fit model to predict treatment from budget
full_forest <- randomForest(as.factor(treat) ~ .,
                            data = imputed,
                            importance = TRUE)
```

```{r,echo = FALSE, message = FALSE, warning = FALSE}
as.data.frame(importance(full_forest)) |> 
  rownames_to_column(var = "var") |>
  select(var, MeanDecreaseAccuracy) |> 
  arrange(desc(MeanDecreaseAccuracy)) |> 
  kable(format = "latex", booktabs = TRUE,
        col.names = c("Category", "Mean Decrease Accuracy"),
        caption = "Predictive importance of budget categories") |> 
  kable_styling(latex_options = "scale_down")
```

\clearpage

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Can be adjusted to use original matching dat

library(fuzzyjoin)
lfs_match <- read_csv("Data/KALAHI/PHL-KC Matching Data for Sample/matching data for sample.csv") |> 
  rename(region = reg_psgc, treat = treatment) |> 
  dplyr::select(island, region, mun, treat, pi, bgytot, pop07nso, land, mun_psgc) |> 
  mutate(mun = case_when(
    mun == "Villa Viciosa" ~ "Villaviciosa",
    mun == "Catarman (CAPITAL)" ~ "Catarman",
    mun == "General Macarthur" ~ "General MacArthur",
    mun == "Macarthur" ~ "MacArthur",
    mun == "Brooke's point" ~ "Brooke's Point",
    mun == "El Nido (Bacuit)" ~ "El Nido",
    mun == "Romblon (CAPITAL)" ~ "Romblon",
    mun == "Lau-an" ~ "Lau An",
    mun == "Tobias Fornier (Dao)" ~ "Tobias Fornier",
    mun == "Ipil (CAPITAL)" ~ "Ipil",
    mun == "Roseller Lim" ~ "R. T. Lim",
    mun == "Licuan-Baay (Licuan)" ~ "Baay Licuan",
    mun == "Asuncion (Saug)" ~ "Asuncion",
    mun == "Lambayong (Mariano Marcos)" ~ "Lambayang",
    mun == "Santa monica (Sapao)" ~ "Santa Monica",
    mun == "San Francisco (Anao-aon)" ~ "San Francisco",
    mun == "Lau-an" ~ "Lau An",
    mun == "Anini-y" ~ "Anini Y",
    .default = mun)) |> 
  arrange(region, mun)

# Merge LFS with covariates and add covariates
lfs <- list.files("Data/Labor Force Surveys") |> 
  map_df(\(x) read_csv(paste0("Data/Labor Force Surveys/", x),
                       col_types = cols(.default = col_character()))) |> 
  mutate(PSU = paste0(REG, PSU)) |> 
  rename(mun_psgc = PSU) |> 
  regex_left_join(lfs_match, by = c("mun_psgc")) |> 
  filter(!is.na(treat)) |> 
  dplyr::select(!matches("\\.x|\\.y")) |>
  mutate(gov_sector = ifelse(C19PCLAS == "2" | J04_OCLS == "2", 1, 0),
         short_term = ifelse(C20_NTEM == "2", 1, 0),
         gov_short_term = ifelse(gov_sector == 1 & short_term == 1, 1, 0)) |>
  mutate(quarter = case_when(
    SVYMO == "01" ~ "Q1",
    SVYMO == "04" ~ "Q2",
    SVYMO == "07" ~ "Q3",
    SVYMO == "10" ~ "Q4"
  )) |> 
  mutate(quarter = paste0(quarter, SVYYR)) |> 
  mutate(work_hrs_last_wk = as.numeric(C22_PHRS))
  

# Merge in vote share data
lfs <- dat |>
  right_join(lfs, by = c("region", "mun", "quarter")) |> 
  rename(treat = treat.x, pop07nso = pop07nso.x, bgytot = bgytot.x, pi = pi.x, land = land.x) |> 
  dplyr::select(!matches("\\.x|\\.y"))

# Run and output glm
casual_gov <- glm(gov_sector ~ treat + as.factor(C06_SEX) + as.numeric(C07_AGE) + pi + I(pop07nso / 1000) + pi +
                    land + bgytot + as.factor(region) + as.factor(quarter), data = lfs, family = "binomial")
casual <- glm(short_term ~ treat + as.factor(C06_SEX) + as.numeric(C07_AGE) + pi + I(pop07nso / 1000) + pi +
                    land + bgytot + as.factor(mun) + as.factor(quarter), data = lfs, family = "binomial")
taxes <- lm_robust(I(total_tax_revenue / pop07nso) ~ treat * tenth_margin + yolanda + I(pop07nso / 1000) + pi +
                        land + bgytot + as.factor(region) + as.factor(quarter), dat)

modelsummary(list("Short term gov employment" = casual,
                  "Tax revenue" = taxes),
             stars = T,
             coef_map = c(
               "treat" = "treat",
               "vote_diff" = "margin of victory",
               "treat:vote_diff" = "treat x margin of victory",
               "as.factor(C06_SEX)2" = "female",
               "as.numeric(C07_AGE)" = "age",
               "I(pop07nso/1000)" = "population",
               "pi" = "poverty incidence",
               "land" = "land area",
               "bgytot" = "num barangays"
             ),
             title = "Effect of Kalahi on taxes and short term government employment",
             output = "kableExtra"
             ) |> kable_classic(latex_options = "hold_position") |> 
  kable_styling(full_width = FALSE, position = "center") |> 
  footnote(general = "Population covariate scaled per 1,000 people such that significant digits are visible in the parameter estimate. Model includes region and quarter-fixed effects.", threeparttable = TRUE, escape = FALSE, footnote_as_chunk = TRUE)
```

\clearpage

# 7 Conclusion

The relationship between external assistance and state capacity remains a central puzzle in political economy. Classical theories of aid fungibility predict that grants displace local spending, yet empirical evidence is inconsistent. In this paper, I ask not only \textit{if} aid substitutes for public spending but \textit{under what conditions}. I advance the debate by showing that democratic institutions determine the fiscal consequences of aid, and that substitution extends beyond intergovernmental transfers to include programs implemented by non-governmental organizations. Even when funds bypass public accounts, politicians internalize external provision as a fiscal windfall, reducing their own effort in overlapping service domains.

Leveraging a randomized evaluation of the World Bank–financed Kalahi-CIDSS program in the Philippines, I provide causal evidence that non-governmental development assistance crowds out local public spending, but that electoral incentives encourage politicians to maintain service provision. Municipalities receiving Kalahi-CIDSS funds reduced government social service expenditures, with no compensating increases elsewhere. However, in municipalities where elections were closely contested, mayors sustained or even increased public programs.

These findings underscore that the democratic context determines whether aid complements or substitutes for the state. Competitive elections constrain opportunistic fiscal behavior by increasing the electoral costs of retrenchment and by compelling incumbents to maintain visible public investment to claim credit credibly. I thus reconcile long-standing inconsistencies in the literature on aid and fiscal substitution, showing that both “crowd-out” and “crowd-in” dynamics emerge endogenously from variation in political accountability.

These results yield clear and constructive policy implications. Bypassing government channels may insulate aid from corruption, yet it does not eliminate political incentives to reallocate effort. External assistance can strengthen or weaken local governance depending on the accountability institutions in place. Development agencies should therefore consider political context as a design parameter in order to maximize welfare gains.

More broadly, this study highlights the importance of democratic institutions in determining the effectiveness of development assistance. Aid does not operate in a political vacuum. By shaping the incentives of elected officials, democratic competition determines whether external resources complement or corrode the institutions they intend to augment.

\clearpage

# References

::: {#refs}
:::

\clearpage

# Appendix

\setcounter{table}{0}
\renewcommand{\thetable}{A\arabic{table}}
\setcounter{figure}{0}
\renewcommand{\thefigure}{A\arabic{figure}}

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Evaluating hypothesis that IE was randomized via randomization inference
# Note: Code provided by Graeme Blair

suppressMessages({
  library(DeclareDesign)
  library(lmtest)
  library(ri2)
  library(nnet)
})

set.seed(252463)

balance_vars <- c("kalahi_spending", 
                  "total_spending", 
                  "pi", 
                  "bgytot", 
                  "pop07nso", 
                  "land")

balance_df <- historic_dat %>%
  filter(as.numeric(year) < 2012) |> 
  select(region, province, treat, all_of(balance_vars)) %>% 
  na.omit

declaration <- 
  with(balance_df,{
    declare_ra(
      blocks = region,
      clusters = province,
      conditions = 0:1
    )
  })

# Robust regression function
regression_fun <- function(data) {
   lm_robust(as.formula(paste0("treat ~ as.factor(region) + ", paste0(balance_vars, collapse = "+"))), clusters =
               province, data = data)
  }

balance_fun <- function(data) {
  data %>% regression_fun %>% glance %>% pull(statistic)
  }

ri2_out <-
  conduct_ri(
    test_function = balance_fun,
    declaration = declaration,
    assignment = "treat",
    sharp_hypothesis = 0,
    sims = 100,
    data = balance_df)

ri2_summ <- summary(ri2_out) %>% rename_with(~paste0(., "_F_ri"))

balance_results <- balance_df %>% 
  regression_fun() %>% 
  tidy %>% 
  filter(term %in% balance_vars) %>% 
  bind_cols(ri2_summ)

# Present results
historic_treat <- historic_dat |> filter(treat == 1)
historic_cont <- historic_dat |> filter(treat == 0)

data.frame(
  var = c("public service spending", "total spending", "poverty index", "num barangay", "population",
          "land area"),
  mean_treat = c(mean(historic_treat$kalahi_spending / historic_treat$pop07nso),
                 mean(historic_treat$total_spending / historic_treat$pop07nso),
                 mean(historic_treat$pi), mean(historic_treat$bgytot),
                 mean(historic_treat$pop07nso), mean(historic_treat$land)),
  mean_cont = c(mean(historic_cont$kalahi_spending / historic_cont$pop07nso),
                mean(historic_cont$total_spending / historic_cont$pop07nso),
                mean(historic_cont$pi), mean(historic_cont$bgytot),
                mean(historic_cont$pop07nso), mean(historic_cont$land)),
  sd_treat = c(sd(historic_treat$kalahi_spending / historic_treat$pop07nso),
               sd(historic_treat$total_spending / historic_treat$pop07nso),
               sd(historic_treat$pi), sd(historic_treat$bgytot),
               sd(historic_treat$pop07nso), sd(historic_treat$land)),
  sd_cont = c(sd(historic_cont$kalahi_spending / historic_cont$pop07nso),
              sd(historic_cont$total_spending / historic_cont$pop07nso),
              sd(historic_cont$pi), sd(historic_cont$bgytot),
              sd(historic_cont$pop07nso), sd(historic_cont$land)),
  p = c(balance_results[1,5], balance_results[2,5], balance_results[3,5],
        balance_results[4,5], balance_results[5,5], balance_results[6,5])
) |>
  kable(
    format = "latex",
    booktabs = TRUE,
    digits = 4,
    caption = "Pretreatment covariate balance"
  ) |>
  kable_styling(font_size = 8, position = "center", latex_options = "HOLD_position")
```

\clearpage

```{r, echo = FALSE, message = FALSE, warning = FALSE}
kalahi_elec <- lm_robust(kalahi_spending_percap ~ treat * vote_diff + yolanda + I(pop07nso / 1000) + pi +
                           land + bgytot + as.factor(region) + as.factor(quarter), dat)
total_elec <- lm_robust(total_spending_percap ~ treat * vote_diff + yolanda + I(pop07nso / 1000) + pi +
                          land + bgytot + as.factor(region) + as.factor(quarter), dat)
kalahi_60 <- lm_robust(kalahi_spending_percap ~ treat * sixtieth_margin + yolanda + I(pop07nso / 1000) + pi +
                         land + bgytot + as.factor(region) + as.factor(quarter), dat)
total_60 <- lm_robust(total_spending_percap ~ treat * sixtieth_margin + yolanda + I(pop07nso / 1000) + pi +
                        land + bgytot + as.factor(region) + as.factor(quarter), dat)
kalahi_50 <- lm_robust(kalahi_spending_percap ~ treat * fiftieth_margin + yolanda + I(pop07nso / 1000) + pi +
                         land + bgytot + as.factor(region) + as.factor(quarter), dat)
total_50 <- lm_robust(total_spending_percap ~ treat * fiftieth_margin + yolanda + I(pop07nso / 1000) + pi +
                        land + bgytot + as.factor(region) + as.factor(quarter), dat)
kalahi_20 <- lm_robust(kalahi_spending_percap ~ treat * twentieth_margin + yolanda + I(pop07nso / 1000) + pi +
                         land + bgytot + as.factor(region) + as.factor(quarter), dat)
total_20 <- lm_robust(total_spending_percap ~ treat * twentieth_margin + yolanda + I(pop07nso / 1000) + pi +
                        land + bgytot + as.factor(region) + as.factor(quarter), dat)
kalahi_10 <- lm_robust(kalahi_spending_percap ~ treat * tenth_margin + yolanda + I(pop07nso / 1000) + pi +
                         land + bgytot + as.factor(region) + as.factor(quarter), dat)
total_10 <- lm_robust(total_spending_percap ~ treat * tenth_margin + yolanda + I(pop07nso / 1000) + pi +
                        land + bgytot + as.factor(region) + as.factor(quarter), dat)

modelsummary(list(
                  "Public services" = kalahi_60,
                  "Total" = total_60,
                  "Public services" = kalahi_50,
                  "Total" = total_50,
                  "Public services" = kalahi_20,
                  "Total" = total_20,
                  "Public services" = kalahi_10,
                  "Total" = total_10),
             stars = T,
             title = "Binary coding for competitiveness",
             coef_map = c(
               "treat" = "treat",
               "vote_diff" = "margin of victory",
               "treat:vote_diff" = "treat x margin of victory",
               "term_limited" = "term limited",
               "treat:vote_diff:term_limited" = "treat x margix of victory x term limited",
               "sixtieth_margin" = "60th margin",
               "treat:sixtieth_margin" = "treat x 60th margin",
               "fiftieth_margin" = "50th margin",
               "treat:fiftieth_margin" = "treat x 50th margin",
               "twentieth_margin" = "20th margin",
               "treat:twentieth_margin" = "treat x 20th margin",
               "tenth_margin" = "10th margin",
               "treat:tenth_margin" = "treat x 10th margin"
             ),
             output = "kableExtra"
             ) |> kable_classic(latex_options = "scale_down") |> 
  kable_styling(full_width = FALSE, position = "center") |> 
  footnote(general = "Spending measured per capita in Philippine pesos.
  Models include region and quarter-level fixed effects, as well as the full range of municipal
  covariates.", threeparttable = TRUE,
  escape = FALSE, footnote_as_chunk = TRUE)
```

\clearpage

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Comparing OOB error rate graphically
data.frame(
  model = c("random", "kalahi", "full", "yolanda"),
  error = c(mean(res$random), mean(res$kalahi), mean(res$full), mean(res$yolanda)),
  low = c(mean(res$random) - 1.96*sd(res$random)/length(res$random),
          mean(res$kalahi) - 1.96*sd(res$kalahi)/length(res$kalahi),
          mean(res$full) - 1.96*sd(res$full)/length(res$full),
          mean(res$yolanda) - 1.96*sd(res$yolanda)/length(res$yolanda)),
  high = c(mean(res$random) + 1.96*sd(res$random)/length(res$random),
           mean(res$kalahi) + 1.96*sd(res$kalahi)/length(res$kalahi),
           mean(res$full) + 1.96*sd(res$full)/length(res$full),
           mean(res$yolanda) + 1.96*sd(res$yolanda)/length(res$yolanda))
) |> ggplot(aes(x = reorder(model, -error), y = error)) +
  geom_point() +
  geom_hline(yintercept = .5, linetype = "dashed") +
  labs(title = "Figure A1: Out of bag error rate across 100 models", x = "Model", y = "Error") +
  geom_errorbar(aes(ymin = low, ymax = high), width = 0.03) +
  theme_minimal()
```

```{r, echo = FALSE, message = FALSE, eval = FALSE}
# Read in WB proj data, identify those w/o disbursements, and merge w locations
loc <- read_csv("Data/WorldBank_GeocodedResearchRelease_Level1_v1.4.2/data/locations.csv")
wb <- read_csv("Data/WorldBank_GeocodedResearchRelease_Level1_v1.4.2/data/projects_ancillary.csv") |> 
  rename(project_id = `PROJECT ID`) |> 
  filter(COUNTRY == "Philippines") |> 
  #filter(`DISBURSED AMOUNT 1` == 0) |> 
  left_join(loc, by = c("project_id")) |> 
  #filter(!is.na(latitude) & !is.na(longitude)) |> 
  filter(grepl("Regional Infrastructure for Growth", `PROJECT NAME`))
  #mutate(approv_date = as.numeric(str_match(`APPROVAL DATE`, "([1-2][0-9][0-9][0-9])")[,2])) |> 
  #filter(approv_date > 2011)

ancillary <- read_csv("Data/WorldBank_GeocodedResearchRelease_Level1_v1.4.2/data/projects_ancillary.csv") |> 
  rename(project_id = `PROJECT ID`)
wb <- read_csv("Data/WorldBank_GeocodedResearchRelease_Level1_v1.4.2/data/projects.csv") |> 
  left_join(loc, by = c("project_id")) |> 
  left_join(ancillary, by = c("project_id"))

wb |> filter(COUNTRY == "Philippines")
  
usaid <- read_excel("Data/USAID_webscraped_data_export_10-2011.xlsx", sheet = "Data")

# Convert to sf object with point geometry
wb <- st_as_sf(
  wb,
  coords = c("longitude", "latitude"),
  crs = 4326  # WGS84 coordinate system
)

# Merge w budget shape file & create binary indicator for receiving a project
dat_wb <- st_join(dat_sf, wb, left = TRUE) |> 
  mutate(wb_proj = ifelse(!is.na(project_id), 1, 0))

# Run regression
wb_proj_total <- lm_robust(I(total_spending / pop07nso) ~ wb_proj
                             + I(pop07nso / 1000) + pi + land + bgytot, dat_wb)

modelsummary(list("Total" = wb_proj_total),
             stars = T,
             title = "Effect of Kalahi on unrelated budget categories",
             output = "kableExtra"
             ) |> kable_classic(latex_options = "scale_down") |> 
  kable_styling(full_width = FALSE, position = "center") |> 
  footnote(general = "Spending measured per capita in Philippine pesos. Population covariate
  scaled per 1,000 people such that significant digits are visible in the parameter estimate.
  Models include region and quarter-level fixed effects.", threeparttable = TRUE,
  escape = FALSE, footnote_as_chunk = TRUE)

dat_wb |> filter(wb_proj == 0)
```
